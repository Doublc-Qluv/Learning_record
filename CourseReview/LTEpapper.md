# LTEInspector: 4G LTE对抗测试的系统方法

- 摘要
  - 本文研究了4G LTE协议的三个关键步骤(即，并在此过程中，发现协议的潜在设计缺陷和涉众使用的不安全实践。为了暴露漏洞，我们提出了一种基于模型的测试方法LTEInspector，该方法在符号攻击者模型中懒散地结合了符号模型检查器和密码协议验证器。使用LTEInspector，我们发现了10个新的攻击和9个以前的攻击，这些攻击被分成3个抽象类(即、安全、用户隐私、服务中断)，在4G LTE的三个程序中。我们的发现中值得注意的是身份验证中继攻击，它使攻击者能够在不拥有适当凭证的情况下，将合法用户的位置欺骗到核心网络。为了确保暴露的攻击构成真正的威胁，并且在实践中确实是可以实现的，我们通过在真实的测试台上进行实验，验证了10种新攻击中的8种及其附带的敌对假设。
- 一、介绍。
  - 第四代长期评估(4G LTE)是移动通信的实际标准，近年来，它的应用稳步增长，取代了前几代，因为它承诺提供更好的保证(如更高的带宽、可靠的连接、更高的安全性)。蜂窝网络是一个国家重要基础设施的一部分，它不仅影响我们整个社会(例如，商业、公共安全信息传播)，而且可以通过使经常提高我们生活质量的应用程序(例如导航)在个人层面对我们产生影响。然而，由于蜂窝网络的普遍存在和在关键应用程序中的应用，它是恶意攻击的目标。足智多谋的对手(如国家、外国情报机构、恐怖分子)可以利用蜂窝网络生态系统的弱点(如监视[1]、网络战[2])进行破坏。因此，研究现有的蜂窝网络设计和部署来检测潜在的漏洞是至关重要的。
  - 已经有大量的工作分析了电信系统的安全和隐私，而且确定了3GPP(第三代伙伴项目)标准[3]、[4]的设计弱点，以及负责任的利益相关者[17]0、[17]1、[17]3、[17]2、[17]4、[10]、[11]、[12]、[13]、[14]、[15]、[16]、[17]的不安全做法。但是，这样的工作至少有以下限制之一:(A)分析没有使用系统的方法来发现攻击[5]、[6]、[7]、[8]、[9]、[10]、[11]、[12]、[13]、[15];(B)分析仅针对前代协议，部分研究结果并不直接适用于4G LTE[5]、[6]、[7]、[8]、[9]、[10]、[11]、[12]、[16];(C)分析没有明确说明对抗性行动[17]的理由。
  - 问题和范围。
    - 4G LTE协议可以被看作是多个关键过程的融合，例如附加、分页、分离、切换和呼叫等。每一个过程都很复杂，需要对其本身进行深入的安全和隐私分析。在不同的过程中，附加、分页和分离对于其他过程的正确和可靠功能至关重要。例如，没有正确和安全的附加程序(即，初始安全连接设置)，安全引导过程可能容易受到攻击;这可能会带来严重的后果，比如中间人攻击、虚假的移动账单，甚至危及生命的风险。因此，本文解决了以下核心研究问题:是否可以开发一种系统的方法来检查附加、分离和分页过程，从而发现可以在实践中被对手实现的漏洞?
  - 挑战。
    - 任何分析4G LTE协议安全性和私密性的测试方法都需要应对以下挑战:(1)规范:蜂窝协议缺乏一个通用规范，标准[3]、[4]常常存在模糊性和规范不足。(b)协议复杂性:由多个(密码)子协议组成的蜂窝协议本质上是有状态的[17]。此外，由于存在多种类型的协议参与者，并且消息包含具有大域的数据，分析可能会遇到可伸缩性挑战。(c)封闭系统:大多数已部署的蜂窝系统是专有的和封闭的系统，需要任何测试方法都是黑盒和系统无关的。(d)法律障碍:监管要求[18]禁止在授权频谱中传输，使得动态网络测试和攻击验证具有挑战性。
  - 方法。
    - 为了分析4G LTE的关键流程，本文首先提出了LTEInspector，它采用了一种基于属性驱动的对抗性模型测试思想。LTEInspector考虑标准符号对手模型(也称为Dolev-Yao模型)对其分析。LTEInspector需要相关的4 g LTE抽象模型Mφ和所需的属性,并试图找到一个违反在Mφ的属性集LTEInspector旨在检查包括真实性。(例如,禁止imperson调),可用性(例如,防止拒绝服务)、完整性(例如,限制未经授权的计费)和保密的用户的敏感信息(例如,防止活动分析)。
    - 作为LTEInspector分析的前提，我们首先参照标准[3]、[4]构建4G LTE生态系统模型。我们的模型M(在https: // github.com/less - warrior/lteinspector中公开可用)捕获4G LTE生态系统的ab- stract功能(忽略底层实现细节)——只与这三个过程的分析相关——作为同步通信有限状态机(FSM)。每个FSM捕获协议参与者的有状态功能(i。e，用户蜂窝设备和核心网络)位于非访问层(NAS)协议层[3]、[4]。两个FSMs通过相互发送NAS层消息，通过公共(反向控制)通信通道进行通信。
    - 我们的分析是参数化系统验证问题(即，参数化为协议参与者的数量)，一般为不可判定的[20];因此，同时达到健全和完整是不可能的。因此，我们遵循以健全而非完整为目标的传统方法，也就是说，如果我们的方法报告了违反，它确实是违反;然而，我们不能发现所有的违规行为。同时,对协议模型的合规检查所需的安全和隐私属性通常需要同时推理:(􏰄)时间顺序不同的事件/操作(即。等,跟踪道具——erties响应属性[21]),(􏰅)密码地-保护信息和结构(例如,加密哈希),和其他(􏰆)丰富的约束(例如,线性整数运算的约束)。通用模型检查器[22],在[23]成功推理关于􏰄和􏰆属性。加密协议审核员[24],[25],[26],[27],[28],[29],虽然精通验证密码学相关属性,温顺的原因只提供原始􏰄和􏰆支持最好的属性。这很自然地引出了一个问题:是否有可能同时利用这两种技术?
    - 为此，LTEInspector懒洋洋地(或按需地)结合了符号模型检查器和密码协议验证器的推理能力。据我们所知，在4G LTE环境下，使用符号模型检验和密码协议验证器来推断丰富的时间跟踪特性是一种新颖的方法。在这种方法中,我们首先cryptography-related构造抽象模型M和所需的属性􏰄φ和唯一原因方面和􏰆φ(用φabs)。任何违反φabs M,象征性的模型检查器将产生一个反例π证明违反。现在,π可能包括对手的行动可能不会变现,由于加密假设违反(例如,构建一个有效的密文信息没有拥有加密密钥)。排除这种情况下,对于每一个对手在π,我们查询加密协议验证器检查行动的可行性与密码一致的假设。以防在π所有对手行动是可行的,我们可以
    - 报告π是一个可行的脆弱性。然而,如果存在一个对手行动π是不可行的,我们完善房地产φabs排除对手采取这一行动的痕迹。然后使用改进的属性再次运行分析。为进一步的信心,我们通过具体执行验证π试验台。
    - 最后，我们展示了一种我们称为攻击链的技术的应用，在这种技术中，看似低影响的攻击被缝合在一起，产生具有破坏性的高影响攻击。我们展示了它的成功应用，通过链接在一起的攻击，公开使用LTEInspector，让对手进行认证中继攻击在4G LTE网络。
  - 发现。
    - 我们的发现中值得注意的是身份验证中继攻击，它允许攻击者在不拥有任何合法凭证的情况下连接到核心网络，同时模拟受害者的蜂窝设备。通过这种攻击，对手可以毒害受害者设备在核心网络中的位置，从而允许在刑事调查期间设置虚假的不在场证明或植入虚假证据。
    - 本文报道的其他一些著名攻击使攻击者能够获得用户的粗粒度位置信息，并安装拒绝服务(DoS)攻击。特别是使用LTEInspector,我们获得的直觉使敌人的攻击可能劫持一个移动设备的寻呼信道,它不仅可以停止(如电话、短信)通知到设备还可以注入捏造消息导致多个影响包括能源消耗和活动分析。
  - 贡献。综上所述，本文的技术贡献如下:
    - (1)我们提出了一种基于系统模型的对抗测试方法lteinspector，它利用符号模型检查器和协议验证器的综合能力来分析三个关键过程(即，连接、分离和分页)的4G LTE网络。LTEInspector使用的一般原则是工具无关的，也就是说，它可以通过任何通用符号模型检查器和密码协议验证器实例化。
    - (2)我们展示了我们的方法在发现新的漏洞和之前的9次攻击方面的有效性。我们的方法已经暴露了10个新的攻击。
    - (3)我们表明，我们的大多数新攻击(即，十有八九是可以在实践中以较低的成本(即在坚持道德、法律和道德实践的同时，真正的试验台。